{"version":3,"file":"useWithdraw.js","sources":["../../../../src/appchain/bridge/hooks/useWithdraw.ts"],"sourcesContent":null,"names":["useWithdraw","config","chain","bridgeParams","chainId","useAccount","switchChainAsync","useSwitchChain","writeContractAsync","data","useWriteContract","wagmiConfig","useConfig","withdrawStatus","setWithdrawStatus","useState","withdrawal","setWithdrawal","finalizedWithdrawalTxHash","setFinalizedWithdrawalTxHash","undefined","sendAnalytics","useAnalytics","resetWithdrawStatus","useCallback","withdraw","recipient","Error","AppchainEvent","AppchainBridgeWithdrawInitiated","amount","tokenAddress","token","address","transactionHash","isCustomGasToken","abi","L2_TO_L1_MESSAGE_PASSER_ABI","functionName","args","BigInt","MIN_GAS_LIMIT","EXTRA_DATA","APPCHAIN_L2_TO_L1_MESSAGE_PASSER_ADDRESS","value","parseEther","StandardBridgeABI","APPCHAIN_BRIDGE_ADDRESS","remoteToken","formattedAmount","parseUnits","decimals","approveTx","erc20Abi","waitForTransactionReceipt","hash","confirmations","AppchainBridgeWithdrawSuccess","error","isUserRejectedRequestError","console","AppchainBridgeWithdrawFailure","message","waitForWithdrawal","txHash","withdrawalReceipt","pollInterval","maxAttempts","attempts","latestBlockNumber","readContract","contracts","l2OutputOracle","L2OutputOracleABI","id","blockNumber","_withdrawal","getWithdrawals","Promise","resolve","setTimeout","AppchainBridgeWaitForClaimFailure","proveAndFinalizeWithdrawal","length","output","getOutput","slot","getWithdrawalHashStorageSlot","withdrawalHash","proof","block","all","getProof","storageKeys","l2BlockNumber","getBlock","l2OutputIndex","outputIndex","outputRootProof","version","OUTPUT_ROOT_PROOF_VERSION","stateRoot","messagePasserStorageRoot","storageHash","latestBlockhash","withdrawalProof","maybeAddProofNode","keccak256","storageProof","_finalizedWithdrawalTxHash","OptimismPortalABI","optimismPortal","AppchainBridgeClaimSuccess","AppchainBridgeClaimFailure"],"mappings":"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"}